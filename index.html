<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok 风格视频站</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: black; color: white; font-family: Arial, sans-serif; overflow: hidden; }
        .video-container { position: fixed; width: 100%; height: 100vh; display: flex; justify-content: center; align-items: center; }
        video { width: 100%; height: 100%; object-fit: cover; }
        .bottom-bar { position: fixed; bottom: 0; width: 100%; display: flex; justify-content: space-around; padding: 10px 0; background: rgba(0, 0, 0, 0.5); }
        .bottom-bar button { background: none; border: none; color: white; font-size: 18px; cursor: pointer; }
        .menu { position: fixed; top: 10px; right: 10px; cursor: pointer; }
        .menu div { width: 30px; height: 4px; background: white; margin: 5px 0; }
        .nav { display: none; position: fixed; top: 0; right: 0; width: 200px; height: 100vh; background: rgba(0, 0, 0, 0.8); padding: 20px; }
        .nav a { display: block; color: white; text-decoration: none; margin: 10px 0; }
        .video-info { position: absolute; bottom: 70px; left: 10px; }
        .video-info p { margin: 5px 0; }
        
        .nav {
    display: none;
    position: fixed;
    top: 0;
    right: 0;
    width: 200px;
    height: 100vh;
    background: rgba(0, 0, 0, 0.8);
    padding: 20px;
}
.nav.active {
    display: block;
}

#searchContainer {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 0, 0, 0.8);
    padding: 15px;
    border-radius: 10px;
    display: none; /* 默认隐藏 */
    z-index: 1000;
}
#searchInput {
    width: 200px;
    padding: 5px;
}
#searchButton {
    margin-left: 5px;
    cursor: pointer;
}

      
    </style>
</head>
<body>
    <div class="video-container">
        <video id="video" autoplay loop></video>
    </div>
    <div class="video-info">
        <p id="username">@用户名</p>
        <p id="tags">#标签</p>
    </div>

   <script>
 let videos = [];
let filteredVideos = []; // 存储搜索结果

async function loadVideos() {
    try {
        let response = await fetch('videos/videos.json');
        videos = await response.json();
        filteredVideos = [...videos]; // 默认播放所有视频
        playRandomVideo();
    } catch (error) {
        console.error("加载视频列表失败:", error);
    }
}

function playRandomVideo() {
    if (filteredVideos.length === 0) {
        alert("未找到相关视频");
        return;
    }
    let randomIndex = Math.floor(Math.random() * filteredVideos.length);
    let data = filteredVideos[randomIndex];
    document.getElementById("video").src = data.videoUrl;
    document.getElementById("username").innerText = "@" + data.username;
    document.getElementById("tags").innerText = data.tags.join(" ");
}

function searchVideos() {
    let query = document.getElementById("searchInput").value.trim().toLowerCase();
    if (query === "") {
        filteredVideos = [...videos]; // 显示所有视频
    } else {
        filteredVideos = videos.filter(video =>
            video.username.toLowerCase().includes(query) ||
            video.tags.some(tag => tag.toLowerCase().includes(query))
        );
    }
    playRandomVideo(); // 重新播放搜索后的结果
}

// PC 端鼠标滚轮事件
document.addEventListener("wheel", (event) => {
    if (event.deltaY > 10 || event.deltaY < -10) {
        playRandomVideo();
    }
});

// 触摸滑动事件（移动端优化）
let touchStartY = 0;
document.addEventListener("touchstart", (evt) => {
    touchStartY = evt.touches[0].clientY;
}, false);

document.addEventListener("touchend", (evt) => {
    let touchEndY = evt.changedTouches[0].clientY;
    if (Math.abs(touchStartY - touchEndY) > 10) {
        playRandomVideo();
    }
}, false);

document.addEventListener("DOMContentLoaded", function () {
    const searchContainer = document.getElementById("searchContainer");
    const searchInput = document.getElementById("searchInput");
    const searchButton = document.getElementById("searchButton");

    // 搜索按钮点击时显示搜索框
    document.getElementById("searchIcon").addEventListener("click", function () {
        searchContainer.style.display = "block";
        searchInput.focus();
    });

    // 监听回车键触发搜索
    searchInput.addEventListener("keypress", function (event) {
        if (event.key === "Enter") {
            searchVideos();
            closeSearch();
        }
    });

    // 关闭搜索框函数
    function closeSearch() {
        searchContainer.style.display = "none";
    }

    // 点击搜索框外部关闭
    document.addEventListener("click", function (event) {
        if (!searchContainer.contains(event.target) && event.target !== searchInput) {
            closeSearch();
        }
    });
});

window.onload = loadVideos;


</script>

    <div class="bottom-bar">
        <button onclick="goHome()">🏠</button>
        <button id="searchIcon">🔍</button>
        <button onclick="togglePlay()">⏸️</button>
        <button onclick="toggleSound()">🔊</button>
    </div>
    <div class="menu" onclick="toggleMenu()">
        <div></div>
        <div></div>
        <div></div>
    </div>
    <div class="nav" id="nav">
        <a href="index.html">首页</a>
        <a href="#">标签</a>
        <a href="#">联系我们</a>
        <a href="#">服务条款</a>
    </div>
   
</body>
</html>
